@using TAU.Website
@using Microsoft.Extensions.Options
@model TAU.Website.Models.Custom_Blocks.NewsletterViewModel
@inject IOptions<GoogleReCaptchaConfig> GoogleRecaptchaConfig
@{
    Layout = null;
}
<h1>Newsletter</h1>
@using (Html.BeginForm("PostNewsletter", "Newsletter", FormMethod.Post))
{
    <div>
        <label asp-for="Email">Email</label>
        <input type="text" id="newsletterEmail" asp-for="Email" name="Email">
    </div>
    <div>
        <input type="hidden" id="newsLetterReCaptchaToken" asp-for="Token" name="Token"/>
    </div>
    <div>
        <input type="submit" value="Subscribe"/>
    </div>
}

<script>
    $(function(){
      grecaptcha.ready(function() {
        grecaptcha.execute('@GoogleRecaptchaConfig.Value.SiteKey', {action: 'submit'}).then(function(token) {
            document.getElementById("newsLetterReCaptchaToken").value = token;
        });
      });
    })
</script>